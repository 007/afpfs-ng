
- is isdir backwards?
- hide malloc() from lib
- fix log handling

- make libafpclient funcs optional
- get rid of syslog.h
- abstract out client-specific features in afp_server and volume

- connection recovery
  - open files
  - locked files

- forget username/password

- man pages

- open directory?

- use fploginext instead of fplogin

- change password


Upcoming features:

* Multiple users: have one afpfsd running and multiple uids doing mounts

* Icon support:
  - full query/result support
  - retrieval tool: a userspace app that can parse icons from resource forks

* Complete implementation of AFP 3.2
  - pretty much every function needs testing and correcting

* Proper utf8 support
  - the structure is there, the specific codepage translation is not
  - need per-volume character encoding

* AFP 2.x support
  - desktop database support

* More UAMs
  - ClientKRB
  - reconnection

* Being able to change password

* chgrp doesn't work if you don't have a common user directory

* Extended attributes 

* Ongoing performance tweaking
  - in mknod(), you only need to do the setfiledirparms if the mode or perms
    are different
  - measurements, comparisons to other clients
  - asynchronous unlocking
  - use rx and tx quantums properly
  - queue writes to be one tx quantum
  - optimize locking
  - don't go back through the select loop to read what comes after the DSI
    packet
  - make a preallocated pool of dsi requests
  - make a preallocated pool for dsi messages
  - is_dir function should look in did cache
  - check to see how Mac OS does locking on writes
  - large block writes for FUSE 3.x

* GUI interface for status messages

* Mount by servername

* libafpclient.so: a shared library for ease of extension (eg. gnome-vfs2)

* use locking primitives in fuse 2.6.1


Development:

* When running afpfsd under gdb, unmount doesn't work because of the use of 
  signals


Protocol bugs:

* Do DSI buffers get trampled if there's more than one being handled at the
  same time?

* If a DSI stream gets broken or there's a protocol error, the connection
  should be reset

* We don't currently handle reconnect flags or timeouts for DSI attention
  packets

Coding

* the apple_translate() function should be truly 'const char * path'

Mounting

* when server is down on mount, version of 0 problem reported to client.
This is easy to reproduce when mounting both local netatalk and remote OSx

* if perms on mountpoint are wrong, it isn't reported

* do correct address/signature matching; right now we don't actually use
  the signature.


Packaging and polish:

* Make startup scripts (not much point without multi-user support)

* Packages for:
  - FC5, FC7
  - Debian, Ubuntu

AFP 2.2 bugs:
  - UTF8 flag is now server-specific, but it should be volume-specific
  - lots, lots more

Other
  - rewrite pick_version to do more intelligent guessing for a version number
  - right now, there's a hard coded 1024 in afp_write()
  - when mounting when server is already down, client complains "Server going down"
  - after many operations, commands no longer work and neither does ^c
  - for some reason, status doesn't show the login message
  - fix FUSE_USE_VERSION definition
  - When passing a sockaddr_un struct, you need to account for the extra
    byte on the end of the path string where the trailing NULL goes. :)



Documentation
  - write manpages


